<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Mentor Profile</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/edit.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/sub-hex-bg.css') }}">
    <script src="{{ url_for('static', filename='js/darkmode.js') }}"></script>
</head>
<body>
    <button class="theme-toggle" id="themeToggle" title="Toggle dark mode">
        <img src="{{ url_for('static', filename='assets/light-mode.png') }}" alt="Toggle theme" class="theme-icon">
    </button>

<div class="shell">

    <!-- HEADER PANEL -->
    <div class="panel page-header">
        <div class="page-header-row">
            <div>
                <h1 class="page-title">Edit Mentor Profile</h1>
                <p class="muted">
                    Let students know who you are and what you can help with.
                </p>
            </div>

            <a href="{{ url_for('dashboard') }}" class="back-link">‚Üê Back to Dashboard</a>
        </div>
    </div>

    <!-- MAIN EDIT PANEL -->
    <div class="panel edit-panel">
        <!-- LEFT: account + pfp -->
        <div class="profile-side">
            <div class="pfp-block">
                {% if profile and profile.pfp %}
                    <img src="{{ url_for('static', filename='uploads/pfp/' ~ profile.pfp) }}"
                         alt="Profile Picture" class="pfp-img">
                {% else %}
                    <img src="{{ url_for('static', filename='uploads/pfp/default_pfp.png') }}"
                         alt="Profile Picture" class="pfp-img">
                {% endif %}
            </div>

            <div class="form-group">
                <label>Username</label>
                <input type="text" class="readonly-field"
                       value="{{ current_user.username }}" disabled>
            </div>

            <div class="form-group">
                <label>Email</label>
                <input type="email" class="readonly-field"
                       value="{{ current_user.email }}" disabled>
            </div>

            <div class="form-group">
                <label for="pfp">Profile Picture</label>
                <input type="file" name="pfp" id="pfp"
                       accept="image/*" form="mentor-edit-form">
            </div>
        </div>

        <!-- RIGHT: form fields -->
        <div class="form-side">
            <form method="POST" enctype="multipart/form-data"
                  id="mentor-edit-form" class="edit-form">

                <!-- Full name -->
                <div class="form-group">
                    <label for="full_name">Full Name</label>
                    <input type="text"
                           id="full_name"
                           name="full_name"
                           value="{{ profile.full_name if profile else '' }}"
                           required>
                </div>

                <!-- Position -->
                <div class="form-group">
                    <label for="position">Position</label>
                    <select id="position" name="position" required>
                        <option value="">-- Select Position --</option>
                        {% for p in POSITION_CHOICES %}
                            <option value="{{ p }}"
                                {% if profile and profile.position == p %}selected{% endif %}>
                                {{ p }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Faculty -->
                <div class="form-group">
                    <label for="faculty">Faculty</label>
                    <select id="faculty" name="faculty" required>
                        <option value="">-- Select Faculty --</option>
                        {% for value, label in FACULTIES %}
                            <option value="{{ value }}"
                                {% if profile and profile.faculty == value %}selected{% endif %}>
                                {{ label }}
                            </option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Office -->
                <div class="form-group">
                    <label for="office_location">Office Location</label>
                    <input type="text"
                           id="office_location"
                           name="office_location"
                           value="{{ profile.office_location or '' }}">
                </div>

                <!-- LinkedIn -->
                <div class="form-group">
                    <label for="linkedin_profile">LinkedIn Profile</label>
                    <input type="url"
                           id="linkedin_profile"
                           name="linkedin_profile"
                           placeholder="https://www.linkedin.com/in/username"
                           value="{{ profile.linkedin_profile or '' }}">
                </div>

                <!-- Expertise -->
                <div class="form-group">
                    <div class="expertise-title">Areas of Expertise (max 3)</div>
                    <div class="expertise-hint">Choose up to three that best describe you.</div>

                    {% set selected_expertise = [] %}
                    {% if profile and profile.expertise %}
                        {% set selected_expertise = profile.expertise.split(';') %}
                    {% endif %}

                    <div class="expertise-grid">
                        {% for area in EXPERTISE_CHOICES %}
                            <label class="expertise-chip">
                                <input
                                    type="checkbox"
                                    name="expertise"
                                    value="{{ area }}"
                                    {% if area in selected_expertise %}checked{% endif %}
                                >
                                <span class="chip-text">{{ area }}</span>
                            </label>
                        {% endfor %}
                        {% with messages = get_flashed_messages(with_categories=true) %}
                            {% if messages %}
                                <div class="flash-container">
                                {% for category, message in messages %}
                                    <div class="flash flash-{{ category }}">
                                        {{ message }}
                                    </div>
                                {% endfor %}
                                </div>
                            {% endif %}
                        {% endwith %}
                    </div>

                </div>

                <button type="submit" class="btn-save">Save Profile</button>
            </form>
        </div>
    </div>
</div>
</body>
</html>
